(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0346643b"],{"1e75":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n("b775");function r(e){return Object(a["a"])({url:"positions",method:"get",params:e})}function s(e){return Object(a["a"])({url:"position/".concat(e),method:"get"})}function o(e){return Object(a["a"])({url:"position",method:"post",data:e})}function i(e,t){return Object(a["a"])({url:"position/".concat(e),method:"put",data:t})}function l(e,t){return Object(a["a"])({url:"position/".concat(e),method:"delete",data:t})}function c(e){return Object(a["a"])({url:"data/positions",method:"get",params:e})}},3081:function(e,t,n){"use strict";var a=n("5530"),r=(n("d3b7"),n("25f0"),n("4c93")),s=n("7bb1");Object(s["c"])("required",Object(a["a"])(Object(a["a"])({},r["c"]),{},{message:" bắt buộc nhập"})),Object(s["c"])("requiredSelect",Object(a["a"])(Object(a["a"])({},r["c"]),{},{message:" bắt buộc chọn"})),Object(s["c"])("ext",Object(a["a"])(Object(a["a"])({},r["a"]),{},{message:" không đúng định dạng"})),Object(s["c"])("regex",Object(a["a"])(Object(a["a"])({},r["b"]),{},{message:" không đúng định dạng"})),Object(s["c"])("max",{validate:function(e,t){return e.toString().length<=t.length},params:["length"],message:" không vượt quá {length} ký tự"}),Object(s["c"])("isLower",{params:["target"],validate:function(e,t){var n=t.target;return!n||+e<+n},message:" phải nhỏ hơn chặn trên"}),t["a"]={data:function(){return{loginFields:{username:"Tên đăng nhập",password:"Mật khẩu"},approverFields:{unit:"Đơn vị",position:"Chức vụ",approver:"Họ và tên"},scorePeriodFields:{name:"Kỳ chấm điểm"},lendingFields:{type:"Loại chấm điểm",name:"Loại hình chấm điểm"},systemFields:{dept1:"Đơn vị",dept1_type:"Loại đơn vị",dept2:"Phòng ban",side:"Miền",name:"Tên",status:"Trạng thái",code:"Mã",position:"Chức vụ",file:"File"},customer_identificationFields:{code_tax:"Mã số thuế",code_reg:"Mã số đăng ký kinh doanh",name_dn:"Tên doanh nghiệp",name_dept:"Tên đơn vị quản lý",code_dept:"Mã đơn vị quản lý"},rank_adjustFields:{rule_change:"Quy tắc điều chỉnh",cause_change:"Nguyên nhân điều chỉnh",reason_change:"Lý do điều chỉnh"},functionsName:{title:"Tiêu đề",path:"Path",icon:"Icon",component:"Mã màn hình",priority:"Thứ tự"},economic_sbvFields:{codeSBV:"Mã ngành kinh tế SBV",nameSBV:"Tên ngành kinh tế SBV",requestChange:"Yêu cầu điều chỉnh",file:"File"},groupFCCFields:{code:"Mã ngành kinh tế FCC",name:"Tên ngành kinh tế FCC",sbv:"Ngành kinh tế SBV",css:"Nhóm ngành"},groupFCCImportFields:{file:"File"},matrixClassifyFields:{nameMatrix:"Tên ma trận",rules:"Loại quy tắc phân loại quy mô",tpBankRule:"Quy tắc phân loại TPBank",pointRule:"Quy tắc phân loại theo điểm chỉ tiêu",establishMatrix:"Thiết lập ma trận",requestChangeMatrix:"Lý do từ chối"},tpBankRuleFields:{name:"Tên quy tắc",unit:"Đơn vị báo cáo tài chính",sales:"Doanh thu",salesCriteria:"Doanh thu - Chọn tiêu chí",equity:"Vốn chủ sở hữu",equityCriteria:"Vốn chủ sở hữu - Chọn tiêu chí",configScalePointList:"Thiết lập điểm quy mô"},salesScalePointFields:{fromSign:"Dấu",fromValue:"Chặn dưới",toValue:"Chặn trên",toSign:"Dấu"},equityScalePointFields:{fromSign:"Dấu",fromValue:"Chặn dưới",toValue:"Chặn trên",toSign:"Dấu"},configScalePointFields:{size:"Size",scale:"Quy mô"},branches:{branchCode:"Mã đơn vị",branchCodeNumber:"Mã số đơn vị",branchTypeName:"Loại đơn vị",branchName:"Tên đơn vị",districtName:"Miền"},departments:{branchName:"Tên đơn vị",name:"Tên phòng ban"},positions:{branchName:"Tên đơn vị",name:"Tên chức vụ",departmentName:"Tên phòng ban"},groups:{name:"Tên nhóm",code:"Mã nhóm"},users:{groupName:"Tên nhóm",username:"Tên đăng nhập",name:"Tên nhân viên"},ruleChangeRankFields:{content:"Lý do"},singleScoringModelKHDNFields:{codeModel:"Mã mô hình đơn",nameModel:"Tên mô hình đơn",typeRank:"Loại xếp hạng",scaleClassify:"Phân loại quy mô",industryGroup:"Nhóm ngành",inputModel:"Tên mô hình nhập liệu",typeCode:"Loại code",fileCodeModel:"File code model",fileImport:"File",userCreated:"Người tạo",userApproved:"Người duyệt"},configParameterPropertyFields:{codeProperty:"Mã thuộc tính",nameProperty:"Tên thuộc tính",description:"Mô tả",file:"File"}}},methods:{messageError:function(e,t){if(void 0!==t)return e+t}}}},3581:function(e,t,n){"use strict";n("98f2")},"391d":function(e,t,n){"use strict";var a=n("b4a5"),r={data:function(){return{loading:null}},methods:{showLoading:function(){var e=this;this.loading=this.$loading({lock:!0,text:"Đang tải"}),setTimeout((function(){e.hideLoading()}),5e4)},hideLoading:function(){this.loading.close()}}},s={data:function(){return{duration:3e3}},methods:{notifySuccess:function(e,t){this.$notify({title:e,message:t,type:"success",duration:this.duration,customClass:"loading-backgroup-success"})},notifyWarning:function(e,t){this.$notify({title:e,message:t,type:"warning",duration:this.duration,customClass:"loading-backgroup-warning"})},notifyInfo:function(e,t){this.$notify({title:e,message:t,type:"info",duration:this.duration,customClass:"loading-backgroup-info"})},notifyError:function(e,t){this.$notify({title:e,message:t,type:"error",duration:this.duration,customClass:"loading-backgroup-error"})}}},o=(n("d3b7"),n("25f0"),{data:function(){return{}},methods:{convertDateToServer:function(e,t){return""===e||void 0===e||null==e?"":this.$moment(e,t).tz(this.$moment.tz.guess(!0)).utc().format()},convertDateToLocal:function(e,t){return""===e||void 0===e||null==e?"":this.$moment.utc(e).parseZone(this.$moment.tz.guess(!0)).local().format(t)},convertDateToLocalUTC:function(e,t){return""===e||void 0===e||null==e?"":this.$moment.utc(e).format(t)},convertDateToAnotherFormat:function(e,t,n){return""===e||void 0===e?"":this.$moment(e,t).format(n)},ConvertTimeRanges:function(e){if(null!=e&&e.toString().length>0){var t=e.split(" to ");return this.TimeRangesModel.from=this.convertDateToAnotherFormat(t[0]+" 00:00:00","DD-MM-YYYY HH:mm:ss","YYYY-MM-DD[T]HH:mm:ss[Z]"),this.TimeRangesModel.to=this.convertDateToAnotherFormat(t[1]+" 23:59:59","DD-MM-YYYY HH:mm:ss","YYYY-MM-DD[T]HH:mm:ss[Z]"),this.TimeRangesModel}return this.TimeRangesModel.to=null,this.TimeRangesModel.from=null,this.TimeRangesModel},ConvertTimeFrom:function(e){return this.convertDateToAnotherFormat(e+" 00:00:00","DD-MM-YYYY HH:mm:ss","YYYY-MM-DD[T]HH:mm:ss[Z]")},ConvertTimeTo:function(e){return this.convertDateToAnotherFormat(e+" 23:59:59","DD-MM-YYYY HH:mm:ss","YYYY-MM-DD[T]HH:mm:ss[Z]")},ConvertTimeFromToDateJava:function(e){return e+" 00:00:00"},ConvertTimeToToDateJava:function(e){return e+" 23:59:59"}}}),i={methods:{hasPermission:function(e,t){return-1!==this.$store.getters.actions[null===e||void 0===e?void 0:e.toLowerCase()].indexOf(t)}}};t["a"]={mixins:[a["a"],r,s,o,i]}},"6e0a":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("list")],1)},r=[],s=(n("ac1f"),n("841c"),n("b0c0"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"col-sm-12 row"},[t("div",{staticClass:"col-sm-3"},[t("span",{},[e._v("Tên đăng nhập")]),t("el-input",{attrs:{placeholder:"Nhập tên đăng nhập"},model:{value:e.search.username,callback:function(t){e.$set(e.search,"username",t)},expression:"search.username"}})],1),t("div",{staticClass:"col-sm-6"},[t("span",{staticStyle:{"padding-left":"7%"}},[e._v("Ngày tạo")]),t("div",{staticClass:"col-sm-12 d-flex justify-content-center"},[t("el-date-picker",{staticStyle:{width:"40%"},attrs:{placeholder:"Từ ngày",type:"date","value-format":"yyyy-MM-dd",format:"dd/MM/yyyy"},model:{value:e.search.createdFrom,callback:function(t){e.$set(e.search,"createdFrom",t)},expression:"search.createdFrom"}}),t("i",{staticClass:"el-icon-minus font-weight-bold",staticStyle:{padding:"1% 2% 0 2%"}}),t("el-date-picker",{staticStyle:{width:"40%"},attrs:{placeholder:"Đến ngày",type:"date",format:"dd/MM/yyyy","value-format":"yyyy-MM-dd"},model:{value:e.search.createdTo,callback:function(t){e.$set(e.search,"createdTo",t)},expression:"search.createdTo"}})],1)]),t("div",{staticClass:"col-sm-3"},[t("span",{},[e._v("Trạng thái")]),t("div",[t("el-select",{staticClass:"w-100",attrs:{placeholder:"Lựa chọn trạng thái"},model:{value:e.search.status,callback:function(t){e.$set(e.search,"status",t)},expression:"search.status"}},e._l(e.listStatus,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)])]),t("div",{staticClass:"col-sm-12 row pt-2"},[t("div",{staticClass:"col-sm-3"},[t("span",{},[e._v("Nhóm người dùng")]),t("el-select",{staticClass:"w-100",attrs:{filterable:"",placeholder:"Lựa chọn nhóm người dùng"},model:{value:e.search.groupId,callback:function(t){e.$set(e.search,"groupId",t)},expression:"search.groupId"}},e._l(e.dataGroups,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("div",{staticClass:"col-sm-6"},[t("span",{staticStyle:{"padding-left":"7%"}},[e._v("Đơn vị")]),t("div",{staticClass:"col-sm-12 d-flex justify-content-center"},[t("el-select",{staticStyle:{width:"86%"},attrs:{filterable:"",placeholder:"Lựa chọn nhóm người dùng"},model:{value:e.search.branchId,callback:function(t){e.$set(e.search,"branchId",t)},expression:"search.branchId"}},e._l(e.dataGroups,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)])]),t("div",{staticClass:"col-sm-12 d-flex justify-content-center pt-4"},[t("el-button",{attrs:{icon:"el-icon-search",type:"primary",plain:""},on:{click:function(t){return e.getUsers()}}},[e._v("Tìm kiếm")]),t("el-button",{attrs:{icon:"el-icon-refresh",type:"warning",plain:""},on:{click:function(t){return e.removeFilter()}}},[e._v("Xoá tìm kiếm")])],1),t("div",{staticClass:"pt-4 pb-4 d-block float-right"},[e.hasPermission(e.$options.name,"user.insert")?t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.showDialog}},[e._v(" Thêm mới ")]):e._e(),e.hasPermission(e.$options.name,"user.import")?t("el-button",{attrs:{type:"warning",plain:""}},[e._v(" Import ")]):e._e(),e.hasPermission(e.$options.name,"user.export")?t("el-button",{attrs:{type:"success",plain:""}},[e._v(" Export ")]):e._e()],1),t("div",{staticClass:"pt-4"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users}},[t("el-table-column",{attrs:{label:"Thao tác"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Sửa",placement:"bottom"}},[e.hasPermission(e.$options.name,"user.update")?t("el-button",{staticClass:"button-custom",attrs:{size:"mini",plain:""},on:{click:function(t){return e.handleEdit(n.$index,n.row)}}},[t("svg-icon",{staticClass:"disabled",attrs:{"icon-class":"edit"}})],1):e._e()],1),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:1===n.row.status?"Tạm ngưng":"Hoạt động",placement:"bottom"}},[e.hasPermission(e.$options.name,"user.change-status")?t("el-button",{staticClass:"button-custom",attrs:{size:"mini",plain:""},on:{click:function(t){return e.handleChangeStatus(n.$index,n.row)}}},[t("svg-icon",{attrs:{"icon-class":1===n.row.status?"deactive":"active"}})],1):e._e()],1)]}}])}),e._l(e.headers,(function(e){return t("el-table-column",{key:e.prop,attrs:{label:e.label,prop:e.prop,formatter:e.formatter,align:e.contentAlign,"header-align":e.headerAlign,"class-name":e.class}})}))],2),t("div",{staticClass:"mt-4 d-block float-right"},[t("el-pagination",{attrs:{"current-page":e.pagination.pageNumber,"page-size":e.pagination.pageSize,"page-sizes":e.pageSizes,layout:"sizes,prev, pager, next, total",total:e.pagination.totalItems},on:{"update:currentPage":function(t){return e.$set(e.pagination,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageNumber",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("ModifyDialog",{attrs:{id:e.id,"show-dialog":e.isShowDialog},on:{hideDialog:e.hideDialog,modifySuccess:e.getUsers}})],1)}),o=[],i=n("c7eb"),l=n("1da1"),c=(n("4de4"),n("d3b7"),n("b775"));function u(e){return Object(c["a"])({url:"users",method:"get",params:e})}function d(e){return Object(c["a"])({url:"user/".concat(e),method:"get"})}function h(e){return Object(c["a"])({url:"user",method:"post",data:e})}function m(e,t){return Object(c["a"])({url:"user/".concat(e),method:"put",data:t})}function p(e,t){return Object(c["a"])({url:"/user/".concat(e,"/change/status"),method:"put",data:t})}function f(e){return Object(c["a"])({url:"roles",method:"get",query:e})}var g=n("97d9"),b=n("391d"),v=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.isAddNew?"Thêm mới người dùng":"Chỉnh sửa người dùng",visible:e.showDialog,fullscreen:""},on:{"update:visible":function(t){e.showDialog=t}}},[t("ValidationObserver",{ref:"createUpdateUser",scopedSlots:e._u([{key:"default",fn:function(n){var a=n.handleSubmit;return[t("el-form",{staticClass:"form-container",attrs:{model:e.user}},[t("h5",{staticClass:"text-warning"},[e._v("I.Thông tin người dùng ")]),t("div",{staticClass:"app-container"},[t("el-row",{staticClass:"pb-3"},[t("el-col",{attrs:{span:16}},[t("ValidationProvider",{attrs:{name:"groupId",rules:"requiredSelect"},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.errors;return[t("el-form-item",{attrs:{prop:"groupId",error:e.messageError(e.groups.name,a[0])}},[t("label",[e._v("Tên nhóm người dùng"),t("span",{staticClass:"text-danger"},[e._v(" * ")])]),t("br"),t("el-select",{staticStyle:{width:"95%"},attrs:{filterable:"",placeholder:"Chọn nhóm người dùng"},model:{value:e.user.groupId,callback:function(t){e.$set(e.user,"groupId",t)},expression:"user.groupId"}},e._l(e.dataGroups,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]}}],null,!0)})],1),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("label",[e._v("Trạng thái"),t("span",{staticClass:"text-danger"},[e._v(" * ")])]),t("br"),t("div",[t("el-select",{staticClass:"w-100",attrs:{placeholder:"Lựa chọn trạng thái"},model:{value:e.user.status,callback:function(t){e.$set(e.user,"status",t)},expression:"user.status"}},e._l(e.listStatus,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)])],1)],1),t("el-row",{staticClass:"pb-3"},[t("el-col",{attrs:{span:8}},[t("ValidationProvider",{attrs:{name:"username",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.errors;return[t("el-form-item",{attrs:{prop:"username",error:e.messageError(e.users.username,a[0])}},[t("label",[e._v("Tên đăng nhập"),t("span",{staticClass:"text-danger"},[e._v(" * ")])]),t("br"),t("el-input",{staticStyle:{width:"90%"},attrs:{disabled:!e.isAddNew,placeholder:"Nhập tên đăng nhập",maxlength:"30","show-word-limit":""},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1)]}}],null,!0)})],1),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("label",[e._v("Email nhân viên"),t("span",{staticClass:"text-danger"},[e._v(" * ")])]),t("br"),t("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"Nhập tên nhân viên",maxlength:"50","show-word-limit":"",disabled:""},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1)],1),t("el-col",{attrs:{span:8}},[t("ValidationProvider",{attrs:{name:"name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.errors;return[t("el-form-item",{attrs:{prop:"name",error:e.messageError(e.users.name,a[0])}},[t("label",[e._v("Tên nhân viên"),t("span",{staticClass:"text-danger"},[e._v(" * ")])]),t("br"),t("el-input",{staticClass:"w-full",attrs:{placeholder:"Nhập tên nhân viên",maxlength:"100","show-word-limit":""},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1)]}}],null,!0)})],1)],1),t("el-row",{staticClass:"pb-4",staticStyle:{display:"none"}},[t("el-col",{attrs:{span:24}},[t("label",[e._v("Danh sách đơn vị quản lý"),t("span",{staticClass:"text-danger"},[e._v(" * ")])]),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Thêm đơn vị",placement:"bottom"}},[t("el-button",{staticClass:"button-custom",on:{click:e.addNewUserBranch}},[t("svg-icon",{staticClass:"disabled",attrs:{"icon-class":"plus-altplus"}})],1)],1),t("br"),t("el-checkbox",{model:{value:e.user.isAllBranches,callback:function(t){e.$set(e.user,"isAllBranches",t)},expression:"user.isAllBranches"}},[e._v("All Branch")]),t("div",{staticClass:"pt-4"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userBranches,border:"","max-height":"300"}},[t("el-table-column",{attrs:{label:"Thao tác",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[0!==n.$index?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Xoá",placement:"bottom"}},[t("el-button",{staticClass:"button-custom",on:{click:function(t){return e.handleDeleteUserBranches(n.$index,n.row)}}},[t("svg-icon",{staticClass:"disabled",attrs:{"icon-class":"remove"}})],1)],1):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{"render-header":e.customizeHeader,label:"Mã số đơn vị",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-select",{staticClass:"w-100",attrs:{filterable:"",placeholder:"Lựa chọn mã số đơn vị"},on:{change:function(t){return e.getDataDepartment(n.row.branchId)}},model:{value:n.row.branchId,callback:function(t){e.$set(n.row,"branchId",t)},expression:"scope.row.branchId"}},e._l(e.dataBranches,(function(e){return t("el-option",{key:e.id,attrs:{label:e.branchCodeNumber,value:e.id}})})),1)]}}],null,!0)}),t("el-table-column",{attrs:{"render-header":e.customizeHeader,label:"Mã đơn vị",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-select",{staticClass:"w-100",attrs:{filterable:"",placeholder:"Lựa chọn mã đơn vị"},on:{change:function(t){return e.getDataDepartment(n.row.branchId)}},model:{value:n.row.branchId,callback:function(t){e.$set(n.row,"branchId",t)},expression:"scope.row.branchId"}},e._l(e.dataBranches,(function(e){return t("el-option",{key:e.id,attrs:{label:e.branchCode,value:e.id}})})),1)]}}],null,!0)}),t("el-table-column",{attrs:{"render-header":e.customizeHeader,label:"Tên đơn vị quản lý",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-select",{staticClass:"w-100",attrs:{filterable:"",placeholder:"Lựa chọn tên đơn vị quản lý"},on:{change:function(t){return e.getDataDepartment(n.row.branchId,n.row)}},model:{value:n.row.branchId,callback:function(t){e.$set(n.row,"branchId",t)},expression:"scope.row.branchId"}},e._l(e.dataBranches,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}],null,!0)}),t("el-table-column",{attrs:{label:"Phòng ban",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-select",{staticClass:"w-100",attrs:{filterable:"",placeholder:"Lựa chọn phòng ban"},on:{change:function(t){return e.getDataPositions(n.row.departmentId,n.row.branchId)}},model:{value:n.row.departmentId,callback:function(t){e.$set(n.row,"departmentId",t)},expression:"scope.row.departmentId"}},e._l(e.dataDepartments,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}],null,!0)}),t("el-table-column",{attrs:{label:"Chức vụ",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-select",{staticClass:"w-100",attrs:{filterable:"",placeholder:"Lựa chọn chức vụ"},model:{value:n.row.positionId,callback:function(t){e.$set(n.row,"positionId",t)},expression:"scope.row.positionId"}},e._l(e.dataPositons,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}],null,!0)}),t("el-table-column",{attrs:{"render-header":e.customizeHeader,label:"Đơn vị chính",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-radio",{attrs:{label:n.$index,size:"small"},model:{value:e.isMain,callback:function(t){e.isMain=t},expression:"isMain"}},[e._v(" ")])]}}],null,!0)})],1)],1)],1)],1)],1),t("h5",{staticClass:"text-warning"},[e._v("II.Danh sách chức năng gán quyền ")]),t("el-row",[t("el-col",{attrs:{span:10}},[t("label",{staticClass:"pl-2 pb-3"},[e._v("Danh sách chức năng gán quyền")]),t("div",{staticClass:"app-container tree-box"},[t("el-tree",{ref:"tree",attrs:{data:e.functions,"node-key":"code","default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.data;return t("span",{staticClass:"custom-tree-node"},[t("span",{class:0==a.status?"text-red":"text-primary"},[e._v(e._s(a.title)+" "+e._s(a.name))])])}}],null,!0)})],1)]),t("el-col",{attrs:{span:1}},[e._v("   ")]),t("el-col",{staticStyle:{display:"none"},attrs:{span:13}},[t("label",{staticClass:"pb-3"},[e._v("Vai trò phê duyệt")]),t("el-table",{staticStyle:{width:"97%"},attrs:{data:e.roles,border:""}},[t("el-table-column",{attrs:{prop:"groupName",label:"Đối tượng","header-align":"center"}}),t("el-table-column",{attrs:{prop:"name",label:"Vai trò",width:"200","header-align":"center"}}),t("el-table-column",{attrs:{width:"250",label:"Luồng duyệt thông thường",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.isShowNormal?t("el-checkbox",{model:{value:n.row.normalValue,callback:function(t){e.$set(n.row,"normalValue",t)},expression:"scope.row.normalValue"}}):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{width:"150",label:"Luồng duyệt nhanh",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.isShowFast?t("el-checkbox",{model:{value:n.row.fastValue,callback:function(t){e.$set(n.row,"fastValue",t)},expression:"scope.row.fastValue"}}):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{width:"100",label:"HO",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.isShowHo?t("el-checkbox",{model:{value:n.row.hoValue,callback:function(t){e.$set(n.row,"hoValue",t)},expression:"scope.row.hoValue"}}):e._e()]}}],null,!0)})],1)],1)],1),t("el-row",{staticClass:"pt-4"},[t("el-form-item",{staticClass:"dialog-footer pr-1-5"},[t("el-button",{attrs:{plain:"",type:"danger"},on:{click:e.hideDialog}},[e._v("Đóng")]),t("el-button",{attrs:{plain:"",type:"primary"},on:{click:function(t){return a(e.save)}}},[e._v(e._s(e.isAddNew?"Đồng ý":"Cập nhật")+" ")])],1)],1)],1)]}}])})],1)],1)},w=[],y=n("b85c"),k=(n("a9e3"),n("99af"),n("a434"),n("3081")),C=n("7bb1"),x=n("935d"),T=n("1e75"),I={name:"ModifyDialog",components:{ValidationObserver:C["a"],ValidationProvider:C["b"]},mixins:[k["a"],b["a"]],props:{showDialog:{type:Boolean,default:!1},id:{type:Number,default:null}},data:function(){return{isAddNew:!0,listStatus:[{value:1,label:"Hoạt động"},{value:0,label:"Tạm ngưng"}],metaDataGroups:{status:1,deleted:0},user:{username:null,groupId:null,status:1,email:null,name:null,isAllBranches:!1,version:0},userBranches:[{branchId:462,positionId:null,departmentId:null,isMian:1}],branchInfo:{branchId:null,departmentId:null,positionId:null},functions:[],dataGroups:[],isMain:0,dataBranches:[],dataDepartments:[],dataPositons:[],group:{code:null,name:null,status:1,description:null,version:null},roles:[],userRoles:[]}},watch:{showDialog:{handler:function(e){var t=this;return Object(l["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=10;break}return n.next=3,t.getDataGroups();case 3:return n.next=5,t.getDataBranches();case 5:return n.next=7,t.getRoles();case 7:t.directInsertOrUpdate(),n.next=11;break;case 10:t.hideDialog();case 11:case"end":return n.stop()}}),n)})))()}},"user.username":{handler:function(e){this.user.email=e+"@tbp.com.vn"}},"user.groupId":{handler:function(e){null!==e&&this.getGroupFunction(e)}}},methods:{getRoles:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n,a,r,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.roles=[],n={},t.next=4,f(n);case 4:if(a=t.sent,200===a.code)for(r=0;r<a.data.length;r++)s={id:a.data[r].id,isShowNormal:a.data[r].normal,normalValue:!1,isShowFast:a.data[r].fast,fastValue:!1,isShowHo:a.data[r].ho,hoValue:!1,groupName:a.data[r].groupName,name:a.data[r].name},e.roles.push(s);case 6:case"end":return t.stop()}}),t)})))()},getGroupFunction:function(e){var t=this;return Object(l["a"])(Object(i["a"])().mark((function n(){var a;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.functions=[],n.next=3,g["c"](e);case 3:a=n.sent,200===a.code&&(t.functions=t.generateTreeMenu(a.data),t.notifyInfo("Thông tin",a.message));case 5:case"end":return n.stop()}}),n)})))()},mapToRequestUserRole:function(){this.userRoles=[];for(var e=0;e<this.roles.length;e++){var t={roleId:this.roles[e].id,normal:!0===this.roles[e].normalValue?1:0,fast:!0===this.roles[e].fastValue?1:0,ho:!0===this.roles[e].hoValue?1:0};this.userRoles.push(t)}return this.userRoles},generateTreeMenu:function(e){var t,n={},a=[],r=Object(y["a"])(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;s.children=[],n[null===s||void 0===s?void 0:s.id]=s}}catch(c){r.e(c)}finally{r.f()}var o,i=Object(y["a"])(e);try{for(i.s();!(o=i.n()).done;){var l=o.value;l.parentId?(n[l.parentId].children.push(l),l.actions&&0!==l.actions.length&&(l.children=l.children.concat(l.actions))):a.push(l)}}catch(c){i.e(c)}finally{i.f()}return a},validateUserBranches:function(){if(this.userBranches=[{branchId:462,positionId:null,departmentId:null,isMian:1}],null===this.isMain)return this.notifyWarning("Thông báo","Vui lòng chọn đơn vị chính"),!1;for(var e=0;e<this.userBranches.length;e++)if(null===this.userBranches[e].branchId)return this.notifyWarning("Thông báo","Vui lòng điền đầy đủ thông tin đơn vị"),!1;return!0},getDataBranches:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.dataBranches=[{branchId:462,positionId:null,departmentId:null,isMian:1}];case 1:case"end":return t.stop()}}),t)})))()},getDataDepartment:function(e,t){var n=this;return Object(l["a"])(Object(i["a"])().mark((function a(){var r,s,o;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.departmentId=null,t.positionId=null,n.dataDepartments=[],r=n.dataBranches.filter((function(t){return t.id===e})),s={branchCode:r[0].code},a.next=7,x["b"](s);case 7:o=a.sent,200===o.code&&(n.dataDepartments=o.data);case 9:case"end":return a.stop()}}),a)})))()},getDataPositions:function(e,t){var n=this;return Object(l["a"])(Object(i["a"])().mark((function a(){var r,s,o,l;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n.dataPositons=[],r=n.dataBranches.filter((function(e){return e.id===t})),s=n.dataDepartments.filter((function(t){return t.id===e})),o={branchCode:r[0].code,departmentCode:s[0].code},a.next=6,T["b"](o);case 6:l=a.sent,200===l.code&&(n.dataPositons=l.data);case 8:case"end":return a.stop()}}),a)})))()},hideDialog:function(){var e=this;this.$nextTick((function(){e.$refs.createUpdateUser.reset()})),this.$emit("hideDialog",!1)},save:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n,a,r,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.validateUserBranches()){t.next=2;break}return t.abrupt("return");case 2:if(!e.isAddNew){t.next=10;break}return n=e.mapRequestForInsert(),t.next=6,h(n);case 6:a=t.sent,200===a.code&&(e.notifySuccess("Thông báo",a.message),e.$emit("modifySuccess"),e.hideDialog()),t.next=16;break;case 10:return r=e.mapRequestForUpdate(),console.log(r),t.next=14,m(e.id,r);case 14:s=t.sent,200===s.code&&(e.notifySuccess("Thông báo",s.message),e.$emit("modifySuccess"),e.hideDialog());case 16:case"end":return t.stop()}}),t)})))()},mapRequestForInsert:function(){var e={username:this.user.username,status:this.user.status,email:this.user.email,name:this.user.name,groupId:this.user.groupId,userBranches:this.userBranches,userRoles:this.mapToRequestUserRole(),isMain:this.isMain,isAllBranches:this.user.isAllBranches};return e},mapRequestForUpdate:function(){var e={username:this.user.username,status:this.user.status,name:this.user.name,groupId:this.user.groupId,userBranches:this.mapToRequestBranches(this.userBranches),userRoles:this.mapToRequestUserRole(),isMain:this.isMain,isAllBranches:this.user.isAllBranches,version:this.user.version};return e},mapToRequestBranches:function(e){for(var t=[],n=0;n<e.length;n++){var a,r,s={branchId:e[n].branchId,departmentId:null===(a=e[n])||void 0===a?void 0:a.departmentId,positionId:null===(r=e[n])||void 0===r?void 0:r.positionIddata};t.push(s)}return console.log(t),t},directInsertOrUpdate:function(){null===this.id?this.isShowAddNew():this.isShowEdit()},isShowAddNew:function(){this.userBranches=[],this.branchInfo={branchId:null,departmentId:null,positionId:null},this.userBranches.push(this.branchInfo),this.user={username:null,groupId:null,status:1,email:null,name:null,isAllBranches:!1},this.functions=[],this.isMain=0,this.isAddNew=!0},addNewUserBranch:function(){this.branchInfo={branchId:null,departmentId:null,positionId:null},this.getDataBranches(),this.userBranches.push(this.branchInfo)},isShowEdit:function(){this.getUser(),this.isAddNew=!1},getUser:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d(e.id);case 2:n=t.sent,200===n.code&&(e.user={username:n.data.username,groupId:n.data.groupId,status:n.data.status,email:n.data.email,name:n.data.name,isAllBranches:n.data.isAllBranches,version:0},e.userBranches=n.data.userBranches,e.roles=e.getUserRoles(n.data.userRoles),e.notifyInfo("Thông tin",n.message));case 4:case"end":return t.stop()}}),t)})))()},getUserRoles:function(e){for(var t=[],n=0;n<this.roles.length;n++)for(var a=0;a<e.length;a++)if(this.roles[n].id===e[a].roleId){var r={id:this.roles[n].id,isShowNormal:this.roles[n].isShowNormal,normalValue:1===e[a].normal,isShowFast:this.roles[n].isShowFast,fastValue:1===e[a].fast,isShowHo:this.roles[n].isShowHo,hoValue:1===e[a].ho,groupName:this.roles[n].groupName,name:this.roles[n].name};t.push(r)}return t},getDataGroups:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={status:e.metaDataGroups.status,deleted:e.metaDataGroups.deleted},t.next=3,g["b"](n);case 3:a=t.sent,200===a.code&&(e.dataGroups=a.data);case 5:case"end":return t.stop()}}),t)})))()},handleDeleteUserBranches:function(e,t){var n=this;this.$confirm("Bạn có chắc chắn muốn xoá bản ghi này không?","Cảnh báo",{confirmButtonText:"Đồng ý",cancelButtonText:"Huỷ",type:"warning",center:!0}).then((function(){n.userBranches.splice(e,1),n.isMain=null,n.notifySuccess("Thông báo","Xoá thành công")})).catch((function(e){}))},customizeHeader:function(e,t){var n=t.column,a=(t.$index,this.$createElement);return a("div",[a("div",{class:"d-block c-header text-center"},[a("span",[n.label," ",a("span",{class:"text-danger"},["* "])])])])}}},S=I,D=(n("8617"),n("2877")),_=Object(D["a"])(S,v,w,!1,null,"8791f5f8",null),O=_.exports,j={name:"User",components:{ModifyDialog:O},mixins:[b["a"]],data:function(){return{dataGroups:[],listStatus:[{value:null,label:"-- Tất cả -- "},{value:0,label:"Tạm ngưng"},{value:1,label:"Hoạt động"}],search:{username:null,createdTo:null,createdFrom:null,groupId:null,branchId:null,status:null},metaDataGroups:{status:1,deleted:0},users:[],headers:[{label:"Tên đăng nhập",prop:"username",formatter:null},{label:"Nhóm người dùng",prop:"groupName",formatter:null},{label:"Mã đơn vị",prop:"listBranchCode",formatter:this.isAllBranches},{label:"Mã số đơn vị",prop:"listBranchCodeNumber",formatter:this.isAllBranches},{label:"Ngày tạo",prop:"createdAt",formatter:this.convertDate},{label:"Trạng thái",prop:"status",formatter:this.convertStatusName,contentAlign:"left",headerAlign:"left"}],isShowDialog:!1,user:{},id:0}},created:function(){this.getUsers(),this.getDataGroups()},methods:{isAllBranches:function(e,t,n,a){return e.allBranches?"Tất cả đơn vị":n},handleChangeStatus:function(e,t){var n=this;this.$confirm("Bạn có chắc chắn muốn "+(1===t.status?"khoá":"mở khoá")+" người dùng?",1===t.status?"Khoá người dùng":"Mở khoá người dùng",{confirmButtonText:"Đồng ý",cancelButtonText:"Đóng",type:"warning",center:!0}).then(Object(l["a"])(Object(i["a"])().mark((function e(){var a,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={version:t.version},e.next=3,p(t.id,a);case 3:r=e.sent,200===r.code&&(n.notifyInfo("Thông tin",r.message),n.getUsers());case 5:case"end":return e.stop()}}),e)})))).catch((function(e){}))},convertDate:function(e){return this.convertDateToLocalUTC(e.createdAt,"DD/MM/YYYY HH:mm:ss")},removeFilter:function(){this.search={username:null,createdTo:null,createdFrom:null,groupId:null,branchId:null,status:null},this.pagination={pageNumber:1,pageSize:10,totalItems:0,totalPages:0},this.getUsers()},convertStatusName:function(e){var t;return null===(t=this.listStatus.filter((function(t){return t.value===e.status}))[0])||void 0===t?void 0:t.label},hideDialog:function(e){this.id=null,this.isShowDialog=e},showDialog:function(){this.id=null,this.isShowDialog=!0},handleEdit:function(e,t){this.id=t.id,this.isShowDialog=!0},handleCurrentChange:function(e){this.pagination.pageNumber=e,this.getUsers()},handleSizeChange:function(e){this.pagination.pageSize=e,this.getUsers()},validateSearchDatetime:function(){return!(null!=this.search.createdFrom&&null!=this.search.createdTo&&this.search.createdFrom>this.search.createdTo)||(this.notifyWarning("Cảnh báo","Từ ngày không được lớn hơn đến ngày"),!1)},getUsers:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.validateSearchDatetime()){t.next=2;break}return t.abrupt("return");case 2:return e.showLoading(),n={username:e.search.username,createdTo:e.search.createdTo,createdFrom:e.search.createdFrom,groupId:e.search.groupId,branchId:e.search.branchId,status:e.search.status,pageIndex:e.pagination.pageNumber,pageSize:e.pagination.pageSize},t.next=6,u(n);case 6:a=t.sent,200===a.code&&(e.users=a.data.result,console.log(e.users),e.pagination={pageNumber:a.data.pageNumber,pageSize:a.data.pageSize,totalItems:a.data.totalItems,totalPages:a.data.totalPages},e.notifyInfo("Thông tin",a.message),e.hideLoading());case 8:case"end":return t.stop()}}),t)})))()},getDataGroups:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={status:e.metaDataGroups.status,deleted:e.metaDataGroups.deleted},t.next=3,g["b"](n);case 3:a=t.sent,200===a.code&&(e.dataGroups=a.data);case 5:case"end":return t.stop()}}),t)})))()}}},M=j,B=(n("3581"),Object(D["a"])(M,s,o,!1,null,"66fe65c1",null)),N=B.exports,F={name:"SysUser",components:{list:N},data:function(){return{}},created:function(){},methods:{}},$=F,V=Object(D["a"])($,a,r,!1,null,null,null);t["default"]=V.exports},8617:function(e,t,n){"use strict";n("d53d")},"935d":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n("b775");function r(e){return Object(a["a"])({url:"departments",method:"get",params:e})}function s(e){return Object(a["a"])({url:"department/".concat(e),method:"get"})}function o(e){return Object(a["a"])({url:"department",method:"post",data:e})}function i(e,t){return Object(a["a"])({url:"department/".concat(e),method:"put",data:t})}function l(e,t){return Object(a["a"])({url:"department/".concat(e),method:"delete",data:t})}function c(e){return Object(a["a"])({url:"data/departments",method:"get",params:e})}},"97d9":function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u}));var a=n("b775");function r(e){return Object(a["a"])({url:"groups",method:"get",params:e})}function s(e){return Object(a["a"])({url:"data/groups",method:"get",params:e})}function o(e){return Object(a["a"])({url:"group/".concat(e),method:"get"})}function i(e){return Object(a["a"])({url:"group",method:"post",data:e})}function l(e,t){return Object(a["a"])({url:"group/".concat(e),method:"put",data:t})}function c(e,t){return Object(a["a"])({url:"/group/".concat(e,"/change/status"),method:"put",data:t})}function u(e,t){return Object(a["a"])({url:"/group-function/".concat(e),method:"get",params:t})}},"98f2":function(e,t,n){},b4a5:function(e,t,n){"use strict";t["a"]={data:function(){return{pagination:{pageNumber:1,pageSize:10,totalItems:0,totalPages:0},pageSizes:[10,20,50,100]}},methods:{}}},d53d:function(e,t,n){}}]);